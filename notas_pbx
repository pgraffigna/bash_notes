# para visualizar el estado de los internos (online-offline)
```console
asterisk -rx "sip show peers"
asterisk -rx "sip show users"
asterisk -rx "sip show user 6299"
```
---
# configuración de red en CentOS
## configuracion estatica
vi /etc/sysconfig/network-scripts/ifcfg-eth0

```console
DEVICE=enp3s0
ONBOOT=yes
IPADDR=192.168.1.10
NETMASK=255.255.255.0
GATEWAY=192.168.1.1
BOOTPROTO=static
HWADDR=00:05:29:E0:4F:3D
TYPE=Ethernet

ifdown enp0s3
ifup enp0s3
```
---
# configuracion dhcp
vi /etc/sysconfig/network-scripts/ifcfg-eth1

```console
DEVICE=enp3s0
ONBOOT=yes
DHCP=yes
BOOTPROTO=dhcp
HWADDR=00:05:29:E0:4F:3D
TYPE=Ethernet

ifdown enp0s3
ifup enp0s3
```
---
# /etc/dahdi/system.conf

```console
# en este caso mg2 es el driver de la placa, reemplazar con lo que corresponda
# con el binario /usr/sbin/dahdi_genconf podemos detectarlo
span=1,0,0,cas,hdb3
cas=1-15:1101
cas=17-31:1101
echocanceller=mg2,1-15,17-31

span=2,0,0,cas,hdb3
cas=32-46:1101
cas=48-62:1101
echocanceller=mg2,32-46,48-62

loadzone=ar
defaultzone=ar
```

# /etc/asterisk/chan_dahdi.conf

```console
[trunkgroups]

[channels]
context=from-pstn
;signalling=fxs_ks
rxwink=300              ; Atlas seems to use long (250ms) winks
usecallerid=yes
hidecallerid=no
callwaiting=yes
usecallingpres=yes
callwaitingcallerid=yes
threewaycalling=yes
transfer=yes
canpark=yes
cancallforward=yes
callreturn=yes
echocancel=yes
echocancelwhenbridged=no
faxdetect=
echotraining=800
rxgain=0.0
txgain=0.0
callgroup=1
pickupgroup=1

;Uncomment these lines if you have problems with the disconection of your analog lines
;busydetect=yes
;busycount=3

language=es_arg
immediate=no

;agregado x ggl
resetinterval=never

group=0
signalling=mfcr2
mfcr2_variant=ar
mfcr2_get_ani_first=no
mfcr2_max_ani=10
mfcr2_max_dnis=4
;mfcr2_max_dnis=10
mfcr2_category=national_subscriber
mfcr2_logdir=span1
mfcr2_logging=all
mfcr2_call_files=yes
mfcr2_mfback_timeout=-1
mfcr2_metering_pulse_timeout=-1
;mfcr2_mfback_timeout=5000
;mfcr2_metering_pulse_timeout=200
mfcr2_logdir=telefonica
mfcr2_logging=all
mfcr2_forced_release=no
mfcr2_charge_calls=yes
channel => 1-15,17-31,32-46,48-62
;channel => 1-15,17-31
```
# fix modulo dahdi
```console
/etc/dahdi/modules --> en este archivo se especifica el modulo a cargar en el kernel al iniciar el equipo si esta vacío ejecutar el binario dahdi_genconf

/usr/sbin/dahdi_genconf --> detecta el hardware y agrega el modulo en este archivo

    # Autogenerated by /usr/sbin/dahdi_genconf (Dahdi::Config::Gen::Modules) on Wed Jun 15 17:02:22 2022
    # If you edit this file and execute /usr/sbin/dahdi_genconf again,
    # your manual changes will be LOST.

    xpp_usb --> nombre de modulo
```
---
# CMD
dahdi_hardware: Muestra las tarjetas conectadas a nuestro servidor y que son detectadas por Asterisk DAHDI

dahdi_scan: Este comando muestra la información de nuestros puertos conectados

amportal restart: Reinicia todos los servicios de Asterisks
